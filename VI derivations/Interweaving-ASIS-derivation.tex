\documentclass[10pt]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{latexsym} 
\usepackage{color}
%\usepackage{epsfig}
\usepackage{graphicx}
%\usepackage[dvips]{graphicx}

\usepackage[matrix,tips,graph,curve]{xy}

\newcommand{\mnote}[1]{${}^*$\marginpar{\footnotesize ${}^*$#1}}
\linespread{1.065}

\makeatletter

\setlength\@tempdima  {5.5in}
\addtolength\@tempdima {-\textwidth}
\addtolength\hoffset{-0.5\@tempdima}
\setlength{\textwidth}{5.5in}
\setlength{\textheight}{8.75in}
\addtolength\voffset{-0.625in}

\makeatother

\makeatletter 
\@addtoreset{equation}{section}
\makeatother

\setlength{\parindent}{0pt}

\renewcommand{\theequation}{\thesection.\arabic{equation}}



\theoremstyle{plain}
\newtheorem{theorem}[equation]{Theorem}
\newtheorem{corollary}[equation]{Corollary}
\newtheorem{lemma}[equation]{Lemma}
\newtheorem{proposition}[equation]{Proposition}
\newtheorem{conjecture}[equation]{Conjecture}
\newtheorem{fact}[equation]{Fact}
\newtheorem{facts}[equation]{Facts}
\newtheorem*{theoremA}{Theorem A}
\newtheorem*{theoremB}{Theorem B}
\newtheorem*{theoremC}{Theorem C}
\newtheorem*{theoremD}{Theorem D}
\newtheorem*{theoremE}{Theorem E}
\newtheorem*{theoremF}{Theorem F}
\newtheorem*{theoremG}{Theorem G}
\newtheorem*{theoremH}{Theorem H}

\theoremstyle{definition}
\newtheorem{definition}[equation]{Definition}
\newtheorem{definitions}[equation]{Definitions}
%\theoremstyle{remark}

\newtheorem{remark}[equation]{Remark}
\newtheorem{remarks}[equation]{Remarks}
\newtheorem{exercise}[equation]{Exercise}
\newtheorem{example}[equation]{Example}
\newtheorem{examples}[equation]{Examples}
\newtheorem{notation}[equation]{Notation}
\newtheorem{question}[equation]{Question}
\newtheorem{assumption}[equation]{Assumption}
\newtheorem*{claim}{Claim}
\newtheorem{answer}[equation]{Answer}
%%%%%% letters %%%%

\newcommand{\fA}{\mathfrak{A}}
\newcommand{\fB}{\mathfrak{B}}
\newcommand{\fC}{\mathfrak{C}}
\newcommand{\fD}{\mathfrak{D}}
\newcommand{\fE}{\mathfrak{E}}
\newcommand{\fF}{\mathfrak{F}}
\newcommand{\fG}{\mathfrak{G}}
\newcommand{\fH}{\mathfrak{H}}
\newcommand{\fI}{\mathfrak{I}}
\newcommand{\fJ}{\mathfrak{J}}
\newcommand{\fK}{\mathfrak{K}}
\newcommand{\fL}{\mathfrak{L}}
\newcommand{\fM}{\mathfrak{M}}
\newcommand{\fN}{\mathfrak{N}}
\newcommand{\fO}{\mathfrak{O}}
\newcommand{\fP}{\mathfrak{P}}
\newcommand{\fQ}{\mathfrak{Q}}
\newcommand{\fR}{\mathfrak{R}}
\newcommand{\fS}{\mathfrak{S}}
\newcommand{\fT}{\mathfrak{T}}
\newcommand{\fU}{\mathfrak{U}}
\newcommand{\fV}{\mathfrak{V}}
\newcommand{\fW}{\mathfrak{W}}
\newcommand{\fX}{\mathfrak{X}}
\newcommand{\fY}{\mathfrak{Y}}
\newcommand{\fZ}{\mathfrak{Z}}

\newcommand{\fa}{\mathfrak{a}}
\newcommand{\fb}{\mathfrak{b}}
\newcommand{\fc}{\mathfrak{c}}
\newcommand{\fd}{\mathfrak{d}}
\newcommand{\fe}{\mathfrak{e}}
\newcommand{\ff}{\mathfrak{f}}
\newcommand{\fg}{\mathfrak{g}}
\newcommand{\fh}{\mathfrak{h}}
%\newcommand{\fi}{\mathfrak{i}}

\newcommand{\fj}{\mathfrak{j}}
\newcommand{\fk}{\mathfrak{k}}
\newcommand{\fl}{\mathfrak{l}}
\newcommand{\fm}{\mathfrak{m}}
\newcommand{\fn}{\mathfrak{n}}
\newcommand{\fo}{\mathfrak{o}}
\newcommand{\fp}{\mathfrak{p}}
\newcommand{\fq}{\mathfrak{q}}
\newcommand{\fr}{\mathfrak{r}}
\newcommand{\fs}{\mathfrak{s}}
\newcommand{\ft}{\mathfrak{t}}
\newcommand{\fu}{\mathfrak{u}}
\newcommand{\fv}{\mathfrak{v}}
\newcommand{\fw}{\mathfrak{w}}
\newcommand{\fx}{\mathfrak{x}}
\newcommand{\fy}{\mathfrak{y}}
\newcommand{\fz}{\mathfrak{z}}


\newcommand{\sA}{\mathcal{A}\,}
\newcommand{\sB}{\mathcal{B}\,}
\newcommand{\sC}{\mathcal{C}}
\newcommand{\sD}{\mathcal{D}\,}
\newcommand{\sE}{\mathcal{E}\,}
\newcommand{\sF}{\mathcal{F}\,}
\newcommand{\sG}{\mathcal{G}\,}
\newcommand{\sH}{\mathcal{H}}
\newcommand{\sI}{\mathcal{I}\,}
\newcommand{\sJ}{\mathcal{J}\,}
\newcommand{\sK}{\mathcal{K}\,}
\newcommand{\sL}{\mathcal{L}\,}
\newcommand{\sM}{\mathcal{M}\,}
\newcommand{\sN}{\mathcal{N}}
\newcommand{\sO}{\mathcal{O}}
\newcommand{\sP}{\mathcal{P}\,}
\newcommand{\sQ}{\mathcal{Q}\,}
\newcommand{\sR}{\mathcal{R}}
\newcommand{\sS}{\mathcal{S}}
\newcommand{\sT}{\mathcal{T}\,}
\newcommand{\sU}{\mathcal{U}\,}
\newcommand{\sV}{\mathcal{V}\,}
\newcommand{\sW}{\mathcal{W}\,}
\newcommand{\sX}{\mathcal{X}\,}
\newcommand{\sY}{\mathcal{Y}\,}
\newcommand{\sZ}{\mathcal{Z}\,}

\newcommand{\IA}{\mathbb{A}}
\newcommand{\IB}{\mathbb{B}}
\newcommand{\IC}{\mathbb{C}}
\newcommand{\ID}{\mathbb{D}}
\newcommand{\IE}{\mathbb{E}}
\newcommand{\IF}{\mathbb{F}}
\newcommand{\IG}{\mathbb{G}}
\newcommand{\IH}{\mathbb{H}}
\newcommand{\II}{\mathbb{I}}
\newcommand{\IK}{\mathbb{K}}
\newcommand{\IL}{\mathbb{L}}
\newcommand{\IM}{\mathbb{M}}
\newcommand{\IN}{\mathbb{N}}
\newcommand{\IO}{\mathbb{O}}
\newcommand{\IP}{\mathbb{P}}
\newcommand{\IQ}{\mathbb{Q}}
\newcommand{\IR}{\mathbb{R}}
\newcommand{\IS}{\mathbb{S}}
\newcommand{\IT}{\mathbb{T}}
\newcommand{\IU}{\mathbb{U}}
\newcommand{\IV}{\mathbb{V}}
\newcommand{\IW}{\mathbb{W}}
\newcommand{\IX}{\mathbb{X}}
\newcommand{\IY}{\mathbb{Y}}
\newcommand{\IZ}{\mathbb{Z}}


 \newcommand{\tA}{\mathrm {A}}
 \newcommand{\tB}{\mathrm {B}}
 \newcommand{\tC}{\mathrm {C}}
 \newcommand{\tD}{\mathrm {D}}
 \newcommand{\tE}{\mathrm {E}}
 \newcommand{\tF}{\mathrm {F}}
 \newcommand{\tG}{\mathrm {G}}
 \newcommand{\tH}{\mathrm {H}}
 \newcommand{\tI}{\mathrm {I}}
 \newcommand{\tJ}{\mathrm {J}}
 \newcommand{\tK}{\mathrm {K}}
 \newcommand{\tL}{\mathrm {L}}
 \newcommand{\tM}{\mathrm {M}}
 \newcommand{\tN}{\mathrm {N}}
 \newcommand{\tO}{\mathrm {O}}
 \newcommand{\tP}{\mathrm {P}}
 \newcommand{\tQ}{\mathrm {Q}}
 \newcommand{\tR}{\mathrm {R}}
 \newcommand{\tS}{\mathrm {S}}
 \newcommand{\tT}{\mathrm {T}}
 \newcommand{\tU}{\mathrm {U}}
 \newcommand{\tV}{\mathrm {V}}
 \newcommand{\tW}{\mathrm {W}}
 \newcommand{\tX}{\mathrm {X}}
 \newcommand{\tY}{\mathrm {Y}}
 \newcommand{\tZ}{\mathrm {Z}}
%%%%%%% macros %%%%%

%% my definitions %%%

\newcommand{\End}{\mathrm{End}}
\newcommand{\tr}{\mathrm{tr}}
%\newcommand{\ind}{\mathrm{ind}}

\renewcommand{\index}{\mathrm{index \,}}
\newcommand{\Hom}{\mathrm{Hom}}
\newcommand{\Aut}{\mathrm{Aut}}
\newcommand{\Trace}{\mathrm{Trace}\,}
\newcommand{\Res}{\mathrm{Res}\,}
\newcommand{\rank}{\mathrm{rank}}
%\renewcommand{\dim}{\mathrm{dim}}

\renewcommand{\deg}{\mathrm{deg}}
\newcommand{\spin}{\rm Spin}
\newcommand{\Spin}{\rm Spin}
\newcommand{\erfc}{\rm erfc\,}
\newcommand{\sgn}{\rm sgn\,}
\newcommand{\Spec}{\rm Spec\,}
\newcommand{\diag}{\rm diag\,}
\newcommand{\Fix}{\mathrm{Fix}}
\newcommand{\Ker}{\mathrm{Ker \,}}
\newcommand{\Coker}{\mathrm{Coker \,}}
\newcommand{\Sym}{\mathrm{Sym \,}}
\newcommand{\Hess}{\mathrm{Hess \,}}
\newcommand{\grad}{\mathrm{grad \,}}
\newcommand{\Center}{\mathrm{Center}}
\newcommand{\Lie}{\mathrm{Lie}}


\newcommand{\ch}{\rm ch} % Chern Character

\newcommand{\rk}{\rm rk} 
%\renewcommand{\c}{\rm c}  % Chern class

\newcommand{\sign}{\rm sign}
\renewcommand\dim{{\rm dim\,}}
\renewcommand\det{{\rm det\,}}
\newcommand{\dimKrull}{{\rm Krulldim\,}}
\newcommand\Rep{\mathrm{Rep}}
\newcommand\Hilb{\mathrm{Hilb}}
\newcommand\vol{\mathrm{vol}}

\newcommand\QED{\hfill $\Box$} %{\bf QED}} 

\newcommand\Pf{\nonintend{\em Proof. }}


\newcommand\reals{{\mathbb R}} 
\newcommand\complexes{{\mathbb C}}
\renewcommand\i{\sqrt{-1}}
\renewcommand\Re{\mathrm Re}
\renewcommand\Im{\mathrm Im}
\newcommand\integers{{\mathbb Z}}
\newcommand\quaternions{{\mathbb H}}


\newcommand\iso{{\cong}} 
\newcommand\tensor{{\otimes}}
\newcommand\Tensor{{\bigotimes}} 
\newcommand\union{\bigcup} 
\newcommand\onehalf{\frac{1}{2}}
%\newcommand\Sym[1]{{Sym^{#1}(\complexes^2)}}

\newcommand\lie[1]{{\mathfrak #1}} 
\renewcommand\fk{\mathfrak{K}}
\newcommand\smooth{\mathcal{C}^{\infty}}
\newcommand\trivial{{\mathbb I}}
\newcommand\widebar{\overline}

%%%%%Delimiters%%%%

\newcommand{\<}{\langle}
\renewcommand{\>}{\rangle}

%\renewcommand{\(}{\left(}
%\renewcommand{\)}{\right)}


%%%% Different kind of derivatives %%%%%

\newcommand{\delbar}{\bar{\partial}}
\newcommand{\pdu}{\frac{\partial}{\partial u}}
%\newcommand{\pd}[1][2]{\frac{\partial #1}{\partial #2}}

%%%%% Arrows %%%%%
%\renewcommand{\ra}{\rightarrow}                   % right arrow
%\newcommand{\lra}{\longrightarrow}              % long right arrow
%\renewcommand{\la}{\leftarrow}                    % left arrow
%\newcommand{\lla}{\longleftarrow}               % long left arrow
%\newcommand{\ua}{\uparrow}                     % long up arrow
%\newcommand{\na}{\nearrow}                      %  NE arrow
%\newcommand{\llra}[1]{\stackrel{#1}{\lra}}      % labeled long right arrow
%\newcommand{\llla}[1]{\stackrel{#1}{\lla}}      % labeled long left arrow
%\newcommand{\lua}[1]{\stackrel{#1}{\ua}}      % labeled  up arrow
%\newcommand{\lna}[1]{\stackrel{#1}{\na}}      % labeled long NE arrow

\newcommand{\into}{\hookrightarrow}
\newcommand{\tto}{\longmapsto}
\def\llra{\longleftrightarrow}

\def\d/{/\mspace{-6.0mu}/}
\newcommand{\git}[3]{#1\d/_{\mspace{-4.0mu}#2}#3}
\newcommand\zetahilb{\zeta_{{\text{Hilb}}}}
\def\Fy{\sF \mspace{-3.0mu} \cdot \mspace{-3.0mu} y}
\def\tv{\tilde{v}}
\def\tw{\tilde{w}}
\def\wt{\widetilde}
\def\wtilde{\widetilde}
\def\what{\widehat}

%%%%%%%%%%%%%%%%%%% Mark's definitions %%%%%%%%%%%%%%%%%%%%

\newcommand{\frakg}{\mbox{\frakturfont g}}
\newcommand{\frakk}{\mbox{\frakturfont k}}
\newcommand{\frakp}{\mbox{\frakturfont p}}
\newcommand{\q}{\mbox{\frakturfont q}}
\newcommand{\frakn}{\mbox{\frakturfont n}}
\newcommand{\frakv}{\mbox{\frakturfont v}}
\newcommand{\fraku}{\mbox{\frakturfont u}}
\newcommand{\frakh}{\mbox{\frakturfont h}}
\newcommand{\frakm}{\mbox{\frakturfont m}}
\newcommand{\frakt}{\mbox{\frakturfont t}}
\newcommand{\G}{\Gamma}
\newcommand{\g}{\gamma}
\newcommand{\fraka}{\mbox{\frakturfont a}}
\newcommand{\db}{\bar{\partial}}
\newcommand{\dbs}{\bar{\partial}^*}
\newcommand{\p}{\partial}

%%%%%%%%%%%%% Bryan's definitions %%%%%%%%%

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand{\Expect}{\mathbb{E}}
\newcommand{\Var}{\text{Var}}
\newcommand{\Prox}{\text{Prox}}


%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%
\begin{document}
%

\title{Updates for interweaving scheme}
%\author{Bryan Liu}


\date{\today}

\maketitle
 

%\setcounter{secnumdepth}{1} 

\setcounter{section}{0}
\section{Step (3) Reparametrization}

In step (3), we seek
\begin{align}
\argmin_{\tilde q(\nu), \tilde q(\theta)} KL\Big(\tilde q(\nu) \tilde q(\theta) \| q(\nu+\theta)q(\theta)\Big)
\end{align}
where $q$ are the results from running CAVI in the sufficient model,
\begin{align*}
q(\nu+\theta) &\sim \mathcal N(\mu^{(t)}, \sigma^2_{\mu^{(t)}})\\
q(\theta) &\sim \mathcal N(\theta^{(t)}, \sigma^2_{\theta^{(t)}})
\end{align*}
and the variational distributions $\tilde q$ are given by
\begin{align}
\tilde q(\nu) &\sim \mathcal N(\hat \nu, \sigma^2_\nu)\\
\tilde q(\theta) &\sim \mathcal N(\hat \theta, \sigma^2_{\theta})
\end{align}

We compute the ELBO,
\begin{align}
\mathcal L &= E_{\tilde q} \Big(\log \frac{q(\nu+\theta)q(\theta)}{\tilde q(\nu) \tilde q(\theta)}\Big)\\
	&= E_{\tilde q}[\log q(\nu+\theta)] + E_{\tilde q}[\log q(\theta)] - E_{\tilde q}[\log \tilde q(\nu)] - E_{\tilde q}[\log \tilde q(\theta)] \\
	&= -\frac{1}{2\sigma^2_{\mu^{(t)}}} E_{\tilde q}[(\nu+\theta - \mu^{(t)})^2] 
	 - \frac{1}{2\sigma^2_{\theta^{(t)}}} E_{\tilde q}[(\theta - \theta^{(t)})^2]
	 + \log \sigma_\nu + \log\sigma_\theta\\
	 &= -\frac{1}{2\sigma^2_{\mu^{(t)}}} \Big[\hat \nu^2 + \sigma^2_\nu + \hat\theta^2 + \sigma^2_\theta + 2\hat\nu\hat\theta - 2\mu^{(t)}(\hat\nu+\hat\theta)\Big]\\
	 &\quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad 
	  - \frac{1}{2\sigma^2_{\theta^{(t)}}} \Big[\hat\theta^2 + \sigma^2_\theta  - 2\hat\theta\theta^{(t)} \Big]
	 + \log \sigma_\nu + \log\sigma_\theta\\
\end{align}

Taking partial derivatives, 
\begin{align}
\frac{\partial \mathcal L}{\partial \hat\nu} &= - \frac{\hat \nu}{\sigma^2_{\mu^{(t)}}} - \frac{\hat \theta}{\sigma^2_{\mu^{(t)}}} +  \frac{\mu^{(t)}}{\sigma^2_{\mu^{(t)}}} \\
\frac{\partial \mathcal L}{\partial \hat\theta} 	&=  - \frac{\hat \theta}{\sigma^2_{\mu^{(t)}}} - \frac{\hat \nu}{\sigma^2_{\mu^{(t)}}} +  \frac{\mu^{(t)}}{\sigma^2_{\mu^{(t)}}} - \frac{\hat\theta}{\sigma^2_{\theta^{(t)}}} + \frac{\theta^{(t)}}{\sigma^2_{\theta^{(t)}}}\\
\frac{\partial \mathcal L}{\partial \sigma_\nu} &= - \frac{\sigma_\nu}{\sigma^2_{\mu^{(t)}}} + \frac{1}{\sigma_\nu}\\
\frac{\partial \mathcal L}{\partial \sigma_\theta} &= - \frac{\sigma_\theta} {\sigma^2_{\mu^{(t)}}} - \frac{\sigma_\theta}{\sigma_{\theta^{(t)}}^2}+ \frac{1}{\sigma_\theta}
\end{align}

Setting these derivatives to zero and solving for the variational parameters, 
\begin{align}
\hat \nu &= \mu^{(t)} - \hat\theta\\
\hat \theta &= \Big(\frac{1}{\sigma^2_{\theta^{(t)}}}  + \frac{1}{\sigma^2_{\mu^{(t)}} }\Big)^{-1}\Big(\frac{\theta^{(t)}}{\sigma^2_{\theta^{(t)}}} + \frac{\mu^{(t)}  - \hat\nu}{\sigma^2_{\mu^{(t)}}}\Big)\\
\sigma_\nu^2 &= \sigma^2_{\mu^{(t)}}\\
\sigma_\theta &= \Big(\frac{1}{\sigma^2_{\theta^{(t)}}}  + \frac{1}{\sigma^2_{\mu^{(t)}} }\Big)^{-1}
\end{align}

In particular, the ELBO is maximized when we set 
\begin{align*}
\hat \nu &= \mu^{(t)} - \theta^{(t)}\\
\hat \theta &= \theta^{(t)}
\end{align*}

\section{Step (6) reparametrization}
Now we derive the updates to compute step (6); we seek
\begin{align}
\argmin_{ q(\mu),  q(\theta)} KL\Big( q(\mu)  q(\theta) \| \tilde q(\mu-\theta) \tilde q(\theta)\Big)
\end{align}
where $\tilde q$ are the results from running CAVI in the ancillary model,
\begin{align*}
\tilde q(\mu-\theta) &\sim \mathcal N(\nu^{(t)}, \sigma^2_{\nu^{(t)}})\\
\tilde q(\theta) &\sim \mathcal N(\theta^{(t)}, \sigma^2_{\theta^{(t)}})
\end{align*}
and the variational distributions $q$ are given by
\begin{align}
q(\mu)   &\sim \mathcal N(\hat \mu, \sigma^2_\mu)\\
q(\theta) &\sim \mathcal N(\hat \theta, \sigma^2_{\theta})
\end{align}
By a similar calculation as above when we computed the ELBO for step (3), 
\begin{align}
\mathcal L &= E_{q}[\log \tilde q(\mu-\theta)] + E_{ q}[\log\tilde q(\theta)] - E_{ q}[\log  q(\mu)] - E_{ q}[\log  q(\theta)]\\
	&= -\frac{1}{2\sigma^2_{\nu^{(t)}}} E_{\tilde q}[(\mu-\theta - \nu^{(t)})^2] 
	 - \frac{1}{2\sigma^2_{\theta^{(t)}}} E_{\tilde q}[(\theta - \theta^{(t)})^2]
	 + \log \sigma_\mu + \log\sigma_\theta\\
	 &= -\frac{1}{2\sigma^2_{\nu^{(t)}}} \Big[\hat \mu^2 + \sigma^2_\mu + \hat\theta^2 + \sigma^2_\theta - 2\hat\mu\hat\theta - 2\nu^{(t)}(\hat\mu-\hat\theta)\Big]\\
	 &\quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad 
	  - \frac{1}{2\sigma^2_{\theta^{(t)}}} \Big[\hat\theta^2 + \sigma^2_\theta  - 2\hat\theta\theta^{(t)} \Big]
	 + \log \sigma_\mu + \log\sigma_\theta\\
\end{align}

Taking partial derivatives, 
\begin{align}
\frac{\partial \mathcal L}{\partial \hat\mu} &= - \frac{\hat \mu}{\sigma^2_{\nu^{(t)}}} + \frac{\hat \theta}{\sigma^2_{\nu^{(t)}}} +  \frac{\nu^{(t)}}{\sigma^2_{\nu^{(t)}}} \\
\frac{\partial \mathcal L}{\partial \hat\theta} 	&=  - \frac{\hat \theta}{\sigma^2_{\nu^{(t)}}}  + \frac{\hat \mu}{\sigma^2_{\nu^{(t)}}} -  \frac{\nu^{(t)}}{\sigma^2_{\nu^{(t)}}} - \frac{\hat\theta}{\sigma^2_{\theta^{(t)}}} + \frac{\theta^{(t)}}{\sigma^2_{\theta^{(t)}}}\\
\frac{\partial \mathcal L}{\partial \sigma_\mu} &= - \frac{\sigma_\mu}{\sigma^2_{\nu^{(t)}}} + \frac{1}{\sigma_\mu}\\
\frac{\partial \mathcal L}{\partial \sigma_\theta} &= - \frac{\sigma_\theta} {\sigma^2_{\nu^{(t)}}} - \frac{\sigma_\theta}{\sigma_{\theta^{(t)}}^2}+ \frac{1}{\sigma_\theta}
\end{align}

Setting these derivatives to zero and solving for the variational parameters, 
\begin{align}
\hat \mu &= \nu^{(t)} + \hat\theta\\
\hat \theta &= \Big(\frac{1}{\sigma^2_{\theta^{(t)}}}  + \frac{1}{\sigma^2_{\nu^{(t)}} }\Big)^{-1}\Big(\frac{\theta^{(t)}}{\sigma^2_{\theta^{(t)}}} + \frac{\hat\mu  - \nu^{(t)}}{\sigma^2_{\nu^{(t)}}}\Big)\\
\sigma_\nu^2 &= \sigma^2_{\nu^{(t)}}\\
\sigma_\theta &= \Big(\frac{1}{\sigma^2_{\theta^{(t)}}}  + \frac{1}{\sigma^2_{\nu^{(t)}} }\Big)^{-1}
\end{align}

In particular, the ELBO is maximized when 
\begin{align*} 
\hat\theta &= \theta^{(t)}\\
\hat \mu &=  \nu^{(t)} + \theta^{(t)}
\end{align*}


\end{document}